{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\INDIA\\\\Documents\\\\MAJOR PROJ\\\\RentPeCar\\\\RentPeCar_Frontend\\\\src\\\\User\\\\Components\\\\Pay.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { useEffect } from \"react\";\nimport swal from \"sweetalert\";\nimport { Redirect, useHistory } from \"react-router\";\nimport { url } from \"../../Commons/constants\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Pay() {\n  _s();\n\n  const [amount, setAmount] = useState('');\n  const [booking, setBooking] = useState({});\n  const history = useHistory();\n  useEffect(() => {\n    let book = JSON.parse(sessionStorage.getItem(\"conBooking\"));\n    let bookId = book.bookingid;\n    console.log(book);\n    console.log(bookId);\n    setBooking(book);\n  }, []);\n\n  function loadScript(src) {\n    return new Promise(resolve => {\n      const script = document.createElement(\"script\");\n      script.src = src;\n\n      script.onload = () => {\n        resolve(true);\n      };\n\n      script.onerror = () => {\n        resolve(false);\n      };\n\n      document.body.appendChild(script);\n    });\n  }\n\n  async function displayRazorpay() {\n    const res = await loadScript(\"https://checkout.razorpay.com/v1/checkout.js\");\n\n    if (!res) {\n      alert(\"Razorpay SDK failed to load. Are you online?\");\n      return;\n    }\n\n    let obj = {\n      \"amount\": JSON.parse(sessionStorage.getItem(\"amount\")),\n      \"bookingid\": JSON.parse(sessionStorage.getItem(\"bookingid\"))\n    };\n    console.log(obj);\n    const result = await axios.post(`http://localhost:4000/api/pay/create_order`, obj);\n\n    if (!result) {\n      alert(\"Server error. Are you online?\");\n      return;\n    }\n\n    sessionStorage.removeItem(\"amount\");\n    var {\n      amount,\n      id: order_id,\n      currency\n    } = result.data;\n    amount = amount * 100;\n    const options = {\n      key: \"rzp_test_htD0V8iqnPJHNN\",\n      // Enter the Key ID generated from the Dashboard\n      amount: amount.toString(),\n      currency: result.data.currency,\n      name: \"RentPeCar\",\n      image: \"http://localhost:1337/logo.png\",\n      description: \"Test Transaction\",\n      order_id: result.data.id,\n      handler: async function (response) {\n        const data = {\n          razorpayPaymentId: response.razorpay_payment_id,\n          razorpayOrderId: response.razorpay_order_id,\n          razorpaySignature: response.razorpay_signature\n        };\n        let d = {\n          \"amount\": JSON.parse(sessionStorage.getItem(\"amount\")),\n          \"bookingid\": JSON.parse(sessionStorage.getItem(\"bookingid\")),\n          \"razorpayPaymentId\": JSON.parse(sessionStorage.getItem(\"razorpayPaymentId\"))\n        };\n        axios.put(`http://localhost:4000/api/pay/update_pay_order`, data).then(res => {\n          // swal(\"Payment Success\",\"You Car Booked, Details Sent, Redirecting to Profile Page\",\"success\");\n          history.push(`/car_type`);\n        }).catch(err => {\n          alert(\"Some Error occured!\");\n          history.goBack();\n        }); // alert(\"Payment Success\");\n      },\n      prefill: {\n        name: \"Ravi Dubey\",\n        email: \"ravi123@gmail.com\",\n        contact: \"7007123456\"\n      },\n      notes: {\n        address: \"\"\n      },\n      theme: {\n        color: \"#61dafb\"\n      }\n    };\n    const paymentObject = new window.Razorpay(options);\n    paymentObject.open();\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    style: {\n      border: \"3px solid blue\",\n      marginTop: \"10%\",\n      padding: \"20px 100px 60px 100px\",\n      maxWidth: \"max-content\",\n      textAlign: \"center\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Checkout to do Payement \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      className: \"mx-auto mt-5\",\n      children: \"Amount to Pay to checkout : \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"mx-auto px-3 mt-3 bg-warning\",\n      style: {\n        width: \"max-content\"\n      },\n      children: [\"Amount : \\u20B9 \", JSON.parse(sessionStorage.getItem(\"amount\"))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn mt-5 mx-2 px-5 btn-m btn-success text-lg\",\n      onClick: displayRazorpay,\n      children: \"Pay\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: history.goBack,\n      className: \"btn mt-5 mx-2 px-5 btn-m btn-danger\",\n      children: \"Back\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 107,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Pay, \"oTrUBkv+DOQxqHqg2lGxaDdIo9w=\", false, function () {\n  return [useHistory];\n});\n\n_c = Pay;\nexport default Pay;\n\nvar _c;\n\n$RefreshReg$(_c, \"Pay\");","map":{"version":3,"names":["React","useState","axios","useEffect","swal","Redirect","useHistory","url","Pay","amount","setAmount","booking","setBooking","history","book","JSON","parse","sessionStorage","getItem","bookId","bookingid","console","log","loadScript","src","Promise","resolve","script","document","createElement","onload","onerror","body","appendChild","displayRazorpay","res","alert","obj","result","post","removeItem","id","order_id","currency","data","options","key","toString","name","image","description","handler","response","razorpayPaymentId","razorpay_payment_id","razorpayOrderId","razorpay_order_id","razorpaySignature","razorpay_signature","d","put","then","push","catch","err","goBack","prefill","email","contact","notes","address","theme","color","paymentObject","window","Razorpay","open","border","marginTop","padding","maxWidth","textAlign","width"],"sources":["C:/Users/INDIA/Documents/MAJOR PROJ/RentPeCar/RentPeCar_Frontend/src/User/Components/Pay.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useEffect } from \"react\";\r\nimport swal from \"sweetalert\";\r\nimport { Redirect, useHistory } from \"react-router\";\r\nimport { url } from \"../../Commons/constants\";\r\n\r\nfunction Pay() {\r\n  const [amount, setAmount] = useState('');\r\n  const [booking, setBooking] = useState({});\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    let book = JSON.parse(sessionStorage.getItem(\"conBooking\"));\r\n    let bookId = book.bookingid;\r\n    console.log(book);\r\n    console.log(bookId);\r\n    setBooking(book);\r\n  }, []);\r\n\r\n  function loadScript(src) {\r\n    return new Promise((resolve) => {\r\n      const script = document.createElement(\"script\");\r\n      script.src = src;\r\n      script.onload = () => {\r\n        resolve(true);\r\n      };\r\n      script.onerror = () => {\r\n        resolve(false);\r\n      };\r\n      document.body.appendChild(script);\r\n    });\r\n  }\r\n\r\n  async function displayRazorpay() {\r\n    const res = await loadScript(\r\n      \"https://checkout.razorpay.com/v1/checkout.js\"\r\n    );\r\n\r\n    if (!res) {\r\n      alert(\"Razorpay SDK failed to load. Are you online?\");\r\n      return;\r\n    }\r\n\r\n    let obj = { \"amount\" : JSON.parse(sessionStorage.getItem(\"amount\")),\r\n                \"bookingid\": JSON.parse(sessionStorage.getItem(\"bookingid\")),\r\n              };\r\n    console.log(obj);\r\n    const result = await axios.post(`http://localhost:4000/api/pay/create_order`,obj);\r\n    if (!result) {\r\n      alert(\"Server error. Are you online?\");\r\n      return;\r\n    }\r\n    sessionStorage.removeItem(\"amount\");\r\n\r\n    var { amount, id: order_id, currency } = result.data;\r\n    amount = amount * 100;\r\n\r\n    const options = {\r\n      key: \"rzp_test_htD0V8iqnPJHNN\", // Enter the Key ID generated from the Dashboard\r\n      amount: amount.toString(),\r\n      currency: result.data.currency,\r\n      name: \"RentPeCar\",\r\n      image: \"http://localhost:1337/logo.png\",\r\n      description: \"Test Transaction\",\r\n      order_id: result.data.id,\r\n      handler: async function (response) {\r\n        const data = {\r\n          razorpayPaymentId: response.razorpay_payment_id,\r\n          razorpayOrderId: response.razorpay_order_id,\r\n          razorpaySignature: response.razorpay_signature,\r\n        };\r\n        let d = {\r\n            \"amount\" : JSON.parse(sessionStorage.getItem(\"amount\")),\r\n            \"bookingid\": JSON.parse(sessionStorage.getItem(\"bookingid\")),\r\n            \"razorpayPaymentId\": JSON.parse(sessionStorage.getItem(\"razorpayPaymentId\")),\r\n        };\r\n\r\n        axios.put(`http://localhost:4000/api/pay/update_pay_order`, data).then((res) => {\r\n            // swal(\"Payment Success\",\"You Car Booked, Details Sent, Redirecting to Profile Page\",\"success\");\r\n            history.push(`/car_type`);\r\n          }).catch((err) => {\r\n            alert(\"Some Error occured!\");\r\n            history.goBack();\r\n          });\r\n\r\n        // alert(\"Payment Success\");\r\n      },\r\n      prefill: {\r\n        name: \"Ravi Dubey\",\r\n        email: \"ravi123@gmail.com\",\r\n        contact: \"7007123456\",\r\n      },\r\n      notes: {\r\n        address: \"\",\r\n      },\r\n      theme: {\r\n        color: \"#61dafb\",\r\n      },\r\n    };\r\n\r\n    const paymentObject = new window.Razorpay(options);\r\n    paymentObject.open();\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\" style={{border:\"3px solid blue\",marginTop:\"10%\",padding:\"20px 100px 60px 100px\",maxWidth:\"max-content\",textAlign:\"center\"}}>\r\n      <h1>Checkout to do Payement </h1>\r\n      <label className=\"mx-auto mt-5\">Amount to Pay to checkout : </label>\r\n      <h2 className=\"mx-auto px-3 mt-3 bg-warning\" style={{width:\"max-content\"}}>Amount : &#8377; {JSON.parse(sessionStorage.getItem(\"amount\"))}</h2>\r\n      <button className=\"btn mt-5 mx-2 px-5 btn-m btn-success text-lg\" onClick={displayRazorpay}>Pay</button>\r\n      <button onClick={history.goBack} className=\"btn mt-5 mx-2 px-5 btn-m btn-danger\">Back</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Pay;"],"mappings":"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"},"metadata":{},"sourceType":"module"}